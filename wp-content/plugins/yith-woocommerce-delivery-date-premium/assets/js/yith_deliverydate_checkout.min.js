jQuery(document).ready(function(e){var d="",t=function(){return e(".shipping_method").length>1?e(".shipping_method:checked").val():e(".shipping_method").val()},a=function(){var d=e(document).find("#ywcdd_process_method").val(),t=e(document).find("#ywcdd_carrier").val(),a={ywcdd_carrier_id:t,ywcdd_process_id:d,action:ywcdd_params.actions.update_datepicker};e(document).find("#ywcdd_datepicker").datepicker("destroy"),""!==t?(e("form.checkout").block(c),e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:a,dataType:"json",success:function(d){e("form.checkout").unblock(),void 0!==d.available_days&&e(document).trigger("ywcdd_found_available_days",[d.available_days,t])}})):(e(document).find(".ywcdd_datepicker_content").hide(),e(document).find(".ywcdd_timeslot_content").hide())},c={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0};e(document).on("ywcdd_found_available_days",function(d,t,a){var i=e(document).find("#ywcdd_datepicker"),o=i.parents(".ywcdd_datepicker_content");if(i.datepicker({dateFormat:ywcdd_params.dateformat,numberOfMonths:1*ywcdd_params.numberOfMonths,yearSuffix:ywcdd_params.yearSuffix,beforeShow:function(d,t){e("#ui-datepicker-div").removeClass("yith_datepicker"),e("#ui-datepicker-div").addClass("yith_datepicker"),setTimeout(function(){e("#ui-datepicker-div").show()},0)},beforeShowDay:function(d){var a=t,c=e.datepicker.formatDate(ywcdd_params.dateformat,d);return[-1!==a.indexOf(c)]},onSelect:function(d,t){var a,i,o,n=t.selectedMonth+1,r=t.selectedDay,_=t.selectedYear+"-"+n+"-"+r;e(document).find(".ywcdd_delivery_date").val(_),a=_,i=e(document).find("#ywcdd_carrier").val(),o={ywcdd_carrier_id:i,ywcdd_date_selected:a,action:ywcdd_params.actions.update_timeslot},e("form.checkout").block(c),e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:o,dataType:"json",success:function(d){var t=d.available_timeslot;e("form.checkout").unblock(),e(document).trigger("ywcdd_found_time_slots",[t,a,i])}})},onClose:function(e,d){void 0!==t&&-1===t.indexOf(e)&&alert("Error: the date "+e+" isn't available")}}),void 0!==t&&t.length>0){var n=t[0],r=t[t.length-1];i.datepicker("option","minDate",n),i.datepicker("option","maxDate",r),i.datepicker("setDate",n),e(".ui-datepicker-current-day").click()}o.show(),"yes"===ywcdd_params.open_datepicker&&i.datepicker("show")}),e(document).on("ywcdd_found_time_slots",function(d,t,a,c){var i=e(document).find(".ywcdd_timeslot_content"),o=i.find("#ywcdd_timeslot"),n=i.find(".ywcdd_timeslot_av");o.find("option").not("[value='']").remove(),e.isEmptyObject(t)?(n.val("no"),i.hide()):(e.each(t,function(d,t){o.append(e("<option></option>").attr("value",d).html(t))}),i.show(),n.val("yes")),o.select2(),o.trigger("change")}),e("form.checkout").on("change","#ywcdd_timeslot",function(d){e("body").trigger("update_checkout")}).on("change","#ywcdd_carrier",function(e){a()}),e(document.body).on("updated_checkout",function(a,c){!function(){var a=e(document).find("#ywcdd_process_method").val(),c=t(),i={ywcdd_update_carrier:"update_carrier",ywcdd_shipping_id:c,ywcdd_process_method:a,action:ywcdd_params.actions.update_carrier_list};d!==c&&e.ajax({type:"POST",url:ywcdd_params.ajax_url,data:i,dataType:"json",success:function(d){d.update_delivery_form&&(e(".ywcdd_select_delivery_date_content").html(d.template),e("body").trigger("init-delivery-fields"))}})}()}),e(document).on("init-delivery-fields",function(c){d=t(),e(document).find("#ywcdd_carrier").select2(),a()}).trigger("init-delivery-fields")});
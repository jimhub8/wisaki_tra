jQuery(document).ready(function(d){var a=d("#ywcdd_general_calendar"),e={message:null,overlayCSS:{background:"#fff",opacity:.6},ignoreIfBlocked:!0},t=function(){$events_json=a.data("ywcdd_events_json"),a.fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},defaultDate:ywcdd_calendar_params.starday,locale:ywcdd_calendar_params.calendar_language,aspectRatio:1.8,editable:!1,eventLimit:!0,events:$events_json,timeFormat:"H:mm",buttonIcons:!1,navLinks:!0,eventRender:function(a,e,t){"holiday"==a.event_type&&(e.append("<span class='ywcdd_delete_calendar'></span>"),e.on("click",".ywcdd_delete_calendar",function(e){var t={ywcdd_event_id:a.id,action:ywcdd_calendar_params.actions.delete_holidays};d.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:t,dataType:"json",success:function(e){"deleted"===e.result&&d("#ywcdd_general_calendar").fullCalendar("removeEvents",a.id)}})})),e.find(".fc-title").html(e.find(".fc-title").text())}})},n=function(){d(document).on("change",'#ywcdd_holiday_list input[id^="ywcdd_holiday"]',function(n){var i=d(this).val(),l={ywcdd_holiday_id:d(this).parents("tr").data("holiday_id"),ywcdd_holiday_enabled:i,action:ywcdd_calendar_params.actions.enable_disable_holidays};d("#ywcdd_holiday_list").block(e),d.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:l,dataType:"json",success:function(e){var n=e.result;a.data("ywcdd_events_json",n),a.fullCalendar("destroy"),t(),d("#ywcdd_holiday_list").unblock()}})}).on("click","#ywcdd_holiday_list a.ywcdd_delete_holiday",function(n){n.preventDefault();d(this).val();var i=d(this).parents("tr"),l={ywcdd_holiday_id:i.data("holiday_id"),ywcdd_holiday_enabled:"no",ywcdd_delete_holiday:"yes",action:ywcdd_calendar_params.actions.enable_disable_holidays};d("#ywcdd_holiday_list").block(e),d.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:l,dataType:"json",success:function(e){var n=e.result;a.data("ywcdd_events_json",n),a.fullCalendar("destroy"),t(),d("#ywcdd_holiday_list").unblock(),i.remove()}})})},i=function(){d(document).find(".ywcdd_datepicker").datepicker({dateFormat:ywcdd_calendar_params.dateformat}),d(document).find(".holiday_from").datepicker("option","minDate",0).on("change",function(){var a=d(this),e=a.parent().parent().find(".holiday_to");""!==a.val()?e.datepicker("option","minDate",function(a){var e;try{e=d.datepicker.parseDate(ywcdd_calendar_params.dateformat,a.value)}catch(d){e=null}return e}(this)):e.datepicker("option","minDate",0)})},l=function(a){var e=a.find(".ywcdd_row_holiday"),t=a.find(".ywcdd_edit_row_holiday"),n=a.find(".holiday_from").val(),i=a.find(".holiday_to").val(),l=a.find(".ywcdd_holiday_name").val(),c=a.find("select.ywcdd_how_holiday option:selected"),o="";c.each(function(){o+="<p>"+d(this).html()+"</p>"}),a.find(".ywcdd_row_holiday .ywcdd_holiday_name").html(l),a.find(".ywcdd_row_holiday.how_holiday_for").html(o),a.find(".ywcdd_row_holiday.start_event").html("<p>"+n+"</p>"),a.find(".ywcdd_row_holiday.end_event").html("<p>"+i+"</p>"),e.show(),t.hide()};d(document).on("click",".ywcdd_add_holiday_btn",function(a){a.preventDefault(),d(document).find("#ywcdd_add_new_holiday").slideToggle()}),d(document).on("click","tr td div.ywcdd_row_holiday a.ywcdd_edit_holiday",function(a){a.preventDefault();var e=d(this).parents("tr"),t=e.find(".ywcdd_row_holiday"),n=e.find(".ywcdd_edit_row_holiday");t.hide(),n.show()}),d(document).on("click","#ywcdd_add_new_holiday .yith-add-new-holiday",function(l){l.preventDefault();var c=d(this).parent().parent(),o=c.parents("table"),_=c.find("#ywcdd_add_holiday_name"),y=c.find("#ywcdd_add_holiday_from"),r=c.find("#ywcdd_add_holiday_to"),s=c.find("#ywcdd_add_holiday_how"),h=_.val(),w=y.val(),f=r.val(),u=s.select2("val");if(""!==h&&""!==w&&""!==f&&""!==u){o.block(e),d(document).find(".ywcdd_add_holiday_btn").hide();var p={ywcdd_add_holidays:"add_new_holidays",ywcdd_how_add:u,ywcdd_start_event:w,ywcdd_end_event:f,ywcdd_event_name:h,action:ywcdd_calendar_params.actions.add_holidays};d.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:p,dataType:"json",success:function(e){var l=e.result,c=d(e.list);a.data("ywcdd_events_json",l),a.fullCalendar("destroy"),t(),d(document).find("#ywcdd_holiday_list").html(c),d(document.body).trigger("wc-enhanced-select-init"),d("#ywcdd_holiday_list").find(".yith-plugin-fw-onoff-container span").on("click",function(){var a=d(this).prev("input");a.prop("checked")?a.prop("checked",!1).attr("value","no").removeClass("onoffchecked"):a.prop("checked",!0).attr("value","yes").addClass("onoffchecked"),a.change()}),i(),n(),d("#ywcdd_add_holiday_container").find('input[type="text"], select').each(function(){d(this).is("select")?d(this).val(null).trigger("change"):(d(this).val(""),d(this).hasClass("hasDatepicker")&&d(this).datepicker("option","minDate",0))}),o.unblock()}})}else c.find("input[type='text'], select").change()}),d(document).on("change",".ywcdd_holiday_name, .ywcdd_how_holiday, .holiday_from, .holiday_to",function(a){var e=d(this),t="",n="";e.hasClass("ywcdd_how_holiday")?(t=e.select2("val"),n=d(this).parent().find(".select2-selection")):(t=e.val(),n=e),""===t||null===t?n.addClass("ywcdd_required_field"):n.removeClass("ywcdd_required_field")}),d(document).on("ywcdd_init_calendar_tab",function(){d(document).find("tbody#ywcdd_holiday_body").parent("table").attr("id","ywcdd_holiday_list").addClass("widefat"),a.length&&t(),i(),n(),d(document).on("click","#ywcdd_holiday_list a.ywcdd_update_holiday",function(n){n.preventDefault(),d(this);var i=d(this).parents("tr"),c=i.data("holiday_id"),o=i.find("#"+c).val(),_=i.find(".holiday_from").val(),y=i.find(".holiday_to").val(),r=i.find(".ywcdd_holiday_name").val(),s=i.find(".ywcdd_how_holiday").select2("val");if(""!==_&&""!==y&&""!==r&&null!==s){var h={ywcdd_holiday_id:c,ywcdd_holiday_enabled:o,ywcdd_holiday_for:s,ywcdd_event_name:r,ywcdd_from:_,ywcdd_to:y,action:ywcdd_calendar_params.actions.update_holidays};d("#ywcdd_holiday_list").block(e),d.ajax({type:"POST",url:ywcdd_calendar_params.ajax_url,data:h,dataType:"json",success:function(e){var n=e.result;a.data("ywcdd_events_json",n),a.fullCalendar("destroy"),t(),l(i),d("#ywcdd_holiday_list").unblock()}})}})}).trigger("ywcdd_init_calendar_tab")});